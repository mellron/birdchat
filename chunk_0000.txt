Steps to Link a CUSIP to LEID '010 US Bank National Association' in CPMS

Why it’s missing:
The code that returns Summary builds it as LEID + ' ' + Name, but only for LEIDs that appear in current holdings (via tblSfkpAcct → tblHolding). If LEID '010' doesn’t have any holding rows for that CUSIP, it won’t be included.

1) Confirm the entity row:
SELECT * FROM dbo.tblLglEnty WHERE LEID = '010';

If you need to correct the name:
EXEC dbo.UpdateLglEnty
  @LEID='010', @HeldBy=NULL, @Name='US Bank National Association', @Type=NULL, @LECCtr=NULL;

2) Confirm the CUSIP exists:
SELECT * FROM dbo.tblScrty WHERE Cusip = 'XXXXXXXXX';

3) Check if the CUSIP is already linked to LEID 010:
SELECT TOP 50
  h.HeldBlk, h.Cusip, sa.SfkpAcctID, sa.SfkpID, sa.LEID, le.Name
FROM dbo.tblHolding h
JOIN dbo.tblSfkpAcct sa ON sa.SfkpAcctID = h.SfkpAcctID
JOIN dbo.tblLglEnty  le ON le.LEID = sa.LEID
WHERE h.Cusip = 'XXXXXXXXX' AND sa.LEID = '010';

4) If not linked, create the HeldBlock link:
DECLARE @HeldBlk INT;
EXEC dbo.procGetHeldBlk
  @Cusip   = 'XXXXXXXXX',
  @SfkpID  = 'YYY',     -- safekeeper ID
  @LEID    = '010',
  @HeldBlock = @HeldBlk OUTPUT;
SELECT @HeldBlk AS HeldBlkCreatedOrFound;

5) Validate it now appears in the Summary list:
Once the HeldBlock exists for that CUSIP under LEID '010', the '010 US Bank National Association' Summary will be included in GetOwnerLEID.

Extra tips:
- LEIDs are char(3). Always use '010' (not 10) to preserve leading zero.
- You can enumerate CUSIPs currently linked to a LEID by joining tblLglEnty → tblSfkpAcct → tblHolding for quick audits.


cLglEnty.vb in buisness

in the UI frmLglEnty is called .



Description :

Not exactly — even if the UI lets them run UpdateLglEnty, that will only update the legal entity’s details in tblLglEnty (like the name “US Bank National Association”).

Your issue is that for the given CUSIP, there’s no holding record linking that CUSIP to LEID 010.
GetOwnerLEID builds its Summary list only from LEIDs that have holdings for the CUSIP in question. So:

If the link between CUSIP → safekeeper account → LEID doesn’t exist, changing the legal entity name won’t make it appear.

To fix it, the user (or backend process) needs to create that CUSIP–LEID relationship in tblSfkpAcct/tblHolding — typically via procGetHeldBlk — not just update the entity name.

So in short:

Yes: They can use the UI form to correct the entity’s name if that’s wrong.

No: They can’t resolve the missing Summary value just by running UpdateLglEnty; they’d also need to ensure the CUSIP is tied to that LEID in holdings.
